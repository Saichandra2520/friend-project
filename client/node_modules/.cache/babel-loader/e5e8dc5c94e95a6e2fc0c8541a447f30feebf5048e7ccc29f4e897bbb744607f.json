{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\SIDDH\\\\Desktop\\\\friend project\\\\client\\\\src\\\\context\\\\NotificationsContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from \"react\";\nimport io from \"socket.io-client\";\nimport { useAuth } from \"./AuthContext\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NotificationsContext = /*#__PURE__*/createContext(null);\nexport const NotificationsProvider = ({\n  children\n}) => {\n  _s();\n  const [notifications, setNotifications] = useState([]);\n  const [pendingRequests, setPendingRequests] = useState([]);\n  const [socket, setSocket] = useState(null);\n  const {\n    user\n  } = useAuth();\n  useEffect(() => {\n    if (user) {\n      const newSocket = io(\"http://localhost:7777\");\n      setSocket(newSocket);\n      newSocket.on(\"connect\", () => {\n        newSocket.emit(\"user_connected\", user.userId);\n      });\n      newSocket.on(\"notifications\", data => {\n        setNotifications(data);\n      });\n      newSocket.on(\"pending_requests\", data => {\n        setPendingRequests(data);\n      });\n      newSocket.on(\"new_friend_request\", data => {\n        setNotifications(prev => [data, ...prev]);\n        fetchPendingRequests();\n      });\n      return () => newSocket.close();\n    }\n  }, [user]);\n  const fetchPendingRequests = async () => {\n    try {\n      const response = await axios.get(\"/api/friends/requests\", {\n        headers: {\n          \"x-auth-token\": user\n        }\n      });\n      setPendingRequests(response.data);\n    } catch (error) {\n      console.error(\"Error fetching pending requests:\", error);\n    }\n  };\n  const markAsRead = async notificationId => {\n    try {\n      await axios.put(`http://localhost:7777/api/notifications/${notificationId}/read`, {}, {\n        headers: {\n          \"x-auth-token\": user\n        }\n      });\n      setNotifications(prev => prev.map(n => n._id === notificationId ? {\n        ...n,\n        read: true\n      } : n));\n    } catch (error) {\n      console.error(\"Error marking notification as read:\", error);\n    }\n  };\n  const clearAllNotifications = async () => {\n    try {\n      await axios.delete(\"http://localhost:7777/api/notifications/clear\", {\n        headers: {\n          \"x-auth-token\": user\n        }\n      });\n      setNotifications([]);\n    } catch (error) {\n      console.error(\"Error clearing notifications:\", error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(NotificationsContext.Provider, {\n    value: {\n      notifications,\n      pendingRequests,\n      markAsRead,\n      clearAllNotifications\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n};\n_s(NotificationsProvider, \"lG/IjdXbXLwd+Fh2hjfnuP6LFjU=\", false, function () {\n  return [useAuth];\n});\n_c = NotificationsProvider;\nexport const useNotifications = () => {\n  _s2();\n  return useContext(NotificationsContext);\n};\n_s2(useNotifications, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"NotificationsProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","io","useAuth","axios","jsxDEV","_jsxDEV","NotificationsContext","NotificationsProvider","children","_s","notifications","setNotifications","pendingRequests","setPendingRequests","socket","setSocket","user","newSocket","on","emit","userId","data","prev","fetchPendingRequests","close","response","get","headers","error","console","markAsRead","notificationId","put","map","n","_id","read","clearAllNotifications","delete","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useNotifications","_s2","$RefreshReg$"],"sources":["C:/Users/SIDDH/Desktop/friend project/client/src/context/NotificationsContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from \"react\";\r\nimport io from \"socket.io-client\";\r\nimport { useAuth } from \"./AuthContext\";\r\nimport axios from \"axios\";\r\n\r\nconst NotificationsContext = createContext(null);\r\n\r\nexport const NotificationsProvider = ({ children }) => {\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [pendingRequests, setPendingRequests] = useState([]);\r\n  const [socket, setSocket] = useState(null);\r\n  const { user } = useAuth();\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      const newSocket = io(\"http://localhost:7777\");\r\n      setSocket(newSocket);\r\n\r\n      newSocket.on(\"connect\", () => {\r\n        newSocket.emit(\"user_connected\", user.userId);\r\n      });\r\n\r\n      newSocket.on(\"notifications\", (data) => {\r\n        setNotifications(data);\r\n      });\r\n\r\n      newSocket.on(\"pending_requests\", (data) => {\r\n        setPendingRequests(data);\r\n      });\r\n\r\n      newSocket.on(\"new_friend_request\", (data) => {\r\n        setNotifications((prev) => [data, ...prev]);\r\n        fetchPendingRequests();\r\n      });\r\n\r\n      return () => newSocket.close();\r\n    }\r\n  }, [user]);\r\n\r\n  const fetchPendingRequests = async () => {\r\n    try {\r\n      const response = await axios.get(\"/api/friends/requests\", {\r\n        headers: { \"x-auth-token\": user },\r\n      });\r\n      setPendingRequests(response.data);\r\n    } catch (error) {\r\n      console.error(\"Error fetching pending requests:\", error);\r\n    }\r\n  };\r\n\r\n  const markAsRead = async (notificationId) => {\r\n    try {\r\n      await axios.put(\r\n        `http://localhost:7777/api/notifications/${notificationId}/read`,\r\n        {},\r\n        {\r\n          headers: { \"x-auth-token\": user },\r\n        }\r\n      );\r\n      setNotifications((prev) =>\r\n        prev.map((n) => (n._id === notificationId ? { ...n, read: true } : n))\r\n      );\r\n    } catch (error) {\r\n      console.error(\"Error marking notification as read:\", error);\r\n    }\r\n  };\r\n\r\n  const clearAllNotifications = async () => {\r\n    try {\r\n      await axios.delete(\"http://localhost:7777/api/notifications/clear\", {\r\n        headers: { \"x-auth-token\": user },\r\n      });\r\n      setNotifications([]);\r\n    } catch (error) {\r\n      console.error(\"Error clearing notifications:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <NotificationsContext.Provider\r\n      value={{\r\n        notifications,\r\n        pendingRequests,\r\n        markAsRead,\r\n        clearAllNotifications,\r\n      }}\r\n    >\r\n      {children}\r\n    </NotificationsContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useNotifications = () => useContext(NotificationsContext);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}